@model ServiceDirectoryTemplate.Models.Team
@{
    //Layout = null;
}
@{
    ViewBag.Title = "Amend Team";
}

<script type="text/javascript">
$(document).ready(function () {
    $("#AddMat").submit(function (e) {
            var form=this;
            if ($(this).valid()) {
                if (form.pendding.value == 1)
                    return false;
                var Address1 = form.AddressLine1.value;
                var PostCode = form.PostCode.value;
                var Town = form.CityTown.value;
                var County = form.County.value;
                var CountryID = form.CountryID.value;
                $.ajax({
                    type: "POST",
                    url: "/Address/AddressIsNew",
                    data: ({ Address1: Address1, PostCode: PostCode, Town: Town, County: County, CountryID: CountryID }),
                    success: function (data) {
                        form.pendding.value=1;
                        if (data == "true") {
                            var re = confirm("Address Details cannot be confirmed\nDo you wish to enter Unconfirmed Address Data");
                            if (re == true) {
                                form.submit();
                            } else {
                                form.AddressLine1.value = "";
                                form.PostCode.value = "";
                                form.CityTown.value = "";
                                form.County.value = "";
                                form.CountryID.selectedIndex = 0;
                                form.AddressLine1.focus();
                            }
                        }
                        else {
                            form.submit();
                        }
                        form.pendding.value=0;
                    }
                });
            }
            return false;
        });
    $("#AddMat").validate({
        errorLabelContainer: $("div.error"),
        rules: {
            TeamName: { required: true, maxlength: 100, remote: { url: "/Team/CheckUnique1/@Model.TeamID" } },
            TeamShortDescription: { required: true, maxlength: 100 },
            TypeOfBusinessID: { required: true },
            ContactName: { required: true }
        },
        messages: {
            TeamName: {
                required: "Please input the Team Name",
                maxlength: "Team Name is too long",
                remote: "Please input other Team Name (the cause is duplicate)"
            },
            TeamShortDescription: {
                required: "Please input the Short Description",
                maxlength: "Short Description is too long"
            },
            TypeOfBusinessID: { required: "Please choose the Bussiness Type" },
            ContactName: { required: "Please choose the Lead Contact" }
        }
    });
});
function ChangeAddr() {
    document.AddMat.CopyAddr[0].checked=false;
    document.AddMat.CopyAddr[1].checked=false;
}
function CopyAddress() {
    if (document.AddMat.CopyAddr[0].checked == true) {
        document.AddMat.AddressLine1.value = document.AddMat.OrgAddr1.value;
        document.AddMat.AddressLine2.value = document.AddMat.OrgAddr2.value;
        document.AddMat.AddressLine3.value = document.AddMat.OrgAddr3.value;
        document.AddMat.PostCode.value = document.AddMat.OrgCode.value;
        document.AddMat.CityTown.value = document.AddMat.OrgTown.value;
        document.AddMat.County.value = document.AddMat.OrgCounty.value;
        for (var i = 0; i < document.AddMat.CountryID.length; i++) {
            if (document.AddMat.CountryID[i].value == document.AddMat.OrgCountry.value)
                document.AddMat.CountryID[i].selected = true;
        }
    }
    else if(document.AddMat.CopyAddr[1].checked == true) {
        document.AddMat.AddressLine1.value = document.AddMat.ParAddr1.value;
        document.AddMat.AddressLine2.value = document.AddMat.ParAddr2.value;
        document.AddMat.AddressLine3.value = document.AddMat.ParAddr3.value;
        document.AddMat.PostCode.value = document.AddMat.ParCode.value;
        document.AddMat.CityTown.value = document.AddMat.ParTown.value;
        document.AddMat.County.value = document.AddMat.ParCounty.value;
        for (var i = 0; i < document.AddMat.CountryID.length; i++) {
            if (document.AddMat.CountryID[i].value == document.AddMat.ParCountry.value)
                document.AddMat.CountryID[i].selected = true;
        }
    }
}
</script>
<form action="/Team/Update/@Model.TeamID" name="AddMat" id="AddMat" method="post">
<input type="hidden" name="pendding" value="0" />
<input type="hidden" name="TeamID" value="@Html.DisplayFor(model => model.TeamID)" />
<div class="container-right">
		<div class="table-content">
			<p style="text-align:left"><a title="List all Organisation" href="/Organisation/List">Organisation </a> &gt; <a title="List all Directorate" href="/Directorate/List">Directorate</a> &gt; <a title="List all Department" href="/Department/List">Department</a> &gt;</p>
			<p style="color:#69a017;font-size:large;margin-bottom:10px;text-align:left">Team Details</p>
			<p>
			
			<span style="float:right;margin-right:10px">
            <input type="button" onclick="window.location='/Team/MarkInactivate/@Model.TeamID'" value="In-activate" />
			<input type="submit" value="Save" /> 
			<a title="Return to amend Department" href="/Department/Amend/@Model.DepID#tabs-2"><input type="button" value="Back" /></a> 
			</span>
			
			</p>
			<div id="tabs">
			<ul>
				<li><a href="#tabs-1">Details</a></li>
			</ul>
			<div id="tabs-1">
			<table class="table-only-border-out" width="750px">
				<tr>
					<td width="130px">Team Name &nbsp;<span style="color:red">*</span></td>
					<td width="230px"><input class="standar-textbox" type="text" name="TeamName" value="@Html.DisplayFor(model => model.TeamName)" /></td>
					<td width="150px">Type of Business<span style="color:red">*</span></td>
					<td width="230px"><input class="lookup-textbox" type="text" name="TypeOfBusinessID" value="@Html.DisplayFor(model => model.TypeOfBusiness)" readonly="readonly"/> <a onclick="SICLookUp('TypeOfBusinessID', 'SICCode')" class="link" style="color:Blue">Lookup</a></td>
				</tr>
				
				<tr>
					<td>Team Short Description&nbsp;<span style="color:red">*</span></td>
					<td><textarea class="standar-textarea" name="TeamShortDescription">@Html.DisplayFor(model => model.TeamShortDescription)</textarea></td>
					<td>SIC Code</td>
					<td><input class="short-textbox" name="SICCode" type="text" readonly="readonly" value="@Model.TeamSICCode" /></td>
				</tr>
				
				
				<TR>
					<TD>Lead Contact</TD>
					<TD><input type="hidden" name="ContactID" value="@Model.LeadContactID" /><input class="lookup-textbox" type="text" name="ContactName" value="@Model.Contact.FirstName" readonly="readonly" /> <a onclick="AddrLookUp('AddMat', 'ContactID', 'ContactName')" class="link" style="color:Blue">Lookup</a></TD>
					<TD rowspan=2>Team Full Description</TD>
					<TD rowspan=2><textarea class="standar-textarea" name="TeamFullDescription">@Html.DisplayFor(model => model.TeamFullDescription)</textarea></TD>
				</TR>
				<TR>
					<TD>Copy Address from</TD>
					<TD>
                    <input type="hidden" name="OrgAddr1" value="@ViewBag.OrgAddr1" />
                    <input type="hidden" name="OrgAddr2" value="@ViewBag.OrgAddr2" />
                    <input type="hidden" name="OrgAddr3" value="@ViewBag.OrgAddr3" />
                    <input type="hidden" name="OrgCode" value="@ViewBag.OrgCode" />
                    <input type="hidden" name="OrgTown" value="@ViewBag.OrgTown" />
                    <input type="hidden" name="OrgCounty" value="@ViewBag.OrgCounty" />
                    <input type="hidden" name="OrgCountry" value="@ViewBag.OrgCountry" />
                    <input type="radio" name="CopyAddr" onclick="CopyAddress()" />Organisation 
                    <input type="hidden" name="ParAddr1" value="@ViewBag.ParAddr1" />
                    <input type="hidden" name="ParAddr2" value="@ViewBag.ParAddr2" />
                    <input type="hidden" name="ParAddr3" value="@ViewBag.ParAddr3" />
                    <input type="hidden" name="ParCode" value="@ViewBag.ParCode" />
                    <input type="hidden" name="ParTown" value="@ViewBag.ParTown" />
                    <input type="hidden" name="ParCounty" value="@ViewBag.ParCounty" />
                    <input type="hidden" name="ParCountry" value="@ViewBag.ParCountry" />
                    <input type="radio" name="CopyAddr" onclick="CopyAddress()" />Parent</TD>
					
				</TR>	
				
				<tr>
					<td>Address Line 1</td>
					<td><input class="standar-textbox" type="text" name="AddressLine1" onchange="ChangeAddr()" value="@Html.DisplayFor(model => model.TeamAddr1)" /></td>
					<td>Phone Number</td>
					<td><input class="standar-textbox" type="text" name="PhoneNumber" value="@Html.DisplayFor(model => model.TeamPhone)" /></td>
				</tr>
				
				<tr>
					<td>Address Line 2</td>
					<td><input class="standar-textbox" type="text" name="AddressLine2" onchange="ChangeAddr()" value="@Html.DisplayFor(model => model.TeamAddr2)" /></td>
					<td>Fax</td>
					<td><input class="standar-textbox" type="text" name="Fax" value="@Html.DisplayFor(model => model.TeamFax)" /></td>
				</tr>
				<tr>
					<td>Address Line 3</td>
					<td><input class="standar-textbox" type="text" name="AddressLine3" onchange="ChangeAddr()" value="@Html.DisplayFor(model => model.TeamAddr3)" /></td>
					<td>Email</td>
					<td><input class="standar-textbox" type="text" name="Email" value="@Html.DisplayFor(model => model.TeamEmail)" /></td>
				</tr>
				
				<tr>
					<td>Postcode</td>
					<td><input type="text" name="PostCode" onchange="ChangeAddr()" value="@Html.DisplayFor(model => model.TeamPostCode)" /><a onclick="PostCodeLookUp('PostCode','AddressLine1','CityTown','County','CountryID','ChangeAddr')" class="link" style="color:Blue">Lookup</a></td>
					<td>Web Address</td>
					<td><input class="standar-textbox" type="text" name="WebAddress" value="@Html.DisplayFor(model => model.TeamWebAddr)" /></td>
				</tr>
				<tr>
					<td>Town/Village/City</td>
					<td><input class="standar-textbox" type="text" name="CityTown" onchange="ChangeAddr()" value="@Html.DisplayFor(model => model.CityTown)" /></td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>Country</td>
					<td><input class="standar-textbox" type="text" name="County" onchange="ChangeAddr()" value="@Html.DisplayFor(model => model.County)" /></td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				
				<tr>
					<td>Nation/Country</td>
					<td>
                    <select class="standar-dropdown" onchange="ChangeAddr()" name="CountryID">
                    <option></option>
                        @foreach (var country in ViewBag.ListCountry)
                        {
                                <option value="@country.CountryID" @if(Model.CountryID==@country.CountryID){ @("selected='selected'")}>@country.CountryName</option>
                        }
                        </select>
                    </td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
			</table>
			
			</div>
            <div class="error"></div>
		</div>
		</div>
	</div>
</form>
